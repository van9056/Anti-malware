package antimalware.scanner.data.scan;

import java.io.BufferedInputStream;
import java.io.File;
import java.io.FileInputStream;
import java.io.IOException;
import java.nio.ByteBuffer;

public class FileObjectContent implements IObjectContent {

    private File file;

    public FileObjectContent(File file) {
        this.file = file;
    }

    @Override
    public long getSize() {
        return file.length();
    }

    @Override
    public int readBlock(int offset, ByteBuffer block) {
        int bytes = 0;
        try (BufferedInputStream bis = new BufferedInputStream(new FileInputStream(file), block.limit())) {
            bis.skip(offset);
            bytes = bis.read(block.array());
        } catch (IOException e) {
            e.printStackTrace();
        }
        return bytes;
    }

    @Override
    public String getName() {
        return file.getName();
    }

    @Override
    public String getPath() {
        return file.getPath();
    }

    public File getFile() {
        return file;
    }
}
