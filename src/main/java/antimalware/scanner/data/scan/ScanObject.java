package antimalware.scanner.data.scan;

import java.util.List;

public class ScanObject {

    private IObjectContent objectContent;   // Абстракция содержимого для сканирования
    private List<ScanRegion> scanRegions;   // Список регионов для сканирования
    private List<ScanObject> scanObjects;   // Список подобъектов
    private String name;    // Название файла или архива
    private String path;    // Полный путь к файлу или архиву

    //private Queue<ScanRegion> queue;    // Очередь для чтения ScanRegion

    public ScanObject(IObjectContent objectContent, List<ScanRegion> scanRegions, List<ScanObject> scanObjects) {
        this.objectContent = objectContent;
        this.scanRegions = scanRegions;
        this.scanObjects = scanObjects;
        this.name = objectContent.getName();
        this.path = objectContent.getPath();
        //resetQueue();
    }

    public String getName() {
        return name;
    }

    public String getPath() {
        return path;
    }

    /*
    private Queue<ScanRegion> initQueue() {
        Queue<ScanRegion> queue = new LinkedList<>();
        if (scanObjects != null && scanObjects.size() > 0) {
            for (ScanObject nextScanObject : scanObjects) {
                queue.addAll(nextScanObject.initQueue());
            }
        } else if (scanRegions != null && scanRegions.size() > 0) {
            queue.addAll(scanRegions);
        }
        return queue;
    }

    public void resetQueue() {
        queue = initQueue();
    }

    public ScanRegion nextScanRegion() {
        return queue.poll();
    }*/

    public List<ScanRegion> getScanRegions() {
        return scanRegions;
    }

    public List<ScanObject> getScanObjects() {
        return scanObjects;
    }
}
