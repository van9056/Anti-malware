package antimalware.scanner.data.report;

import antimalware.database.data.Suspect;
import antimalware.scanner.Initiator;
import antimalware.scanner.data.scan.ScanObject;

import java.util.*;

public class ScanReport {

    private Initiator initiator;
    private Date startDate, stopDate;
    private Map<ScanObject, List<Suspect>> suspects = new HashMap<>();

    public ScanReport(Initiator initiator) {
        this.initiator = initiator;
    }

    public Initiator getInitiator() {
        return initiator;
    }

    public Date getStartDate() {
        return startDate;
    }

    public void setStartDate(Date startDate) {
        this.startDate = startDate;
    }

    public Date getStopDate() {
        return stopDate;
    }

    public void setStopDate(Date stopDate) {
        this.stopDate = stopDate;
    }

    public Map<ScanObject, List<Suspect>> getSuspects() {
        return suspects;
    }

    public void setSuspects(Map<ScanObject, List<Suspect>> suspects) {
        this.suspects = suspects;
    }

    public void addSuspects(ScanObject scanObject, List<Suspect> suspectList) {
        suspects.put(scanObject, suspectList);
    }

    @Override
    public String toString() {
        return "Дата начала сканирования: " + startDate + "\n" +
                "Дата окончания сканирования: " + stopDate + "\n" +
                "Количество обнаруженных угроз: " + suspects.size();
    }
}
