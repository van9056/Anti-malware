package antimalware.scanner.util;

import antimalware.scanner.data.scan.IObjectContent;
import antimalware.scanner.data.scan.ScanObject;

public class ScanObjectBuilder {

    private IObjectContent objectContent;

    public ScanObjectBuilder(IObjectContent objectContent) {
        this.objectContent = objectContent;
    }

    public ScanObject getScanObject() {
        ScanObject scanObject;
        PEScanObjectBuilder pe = new PEScanObjectBuilder(objectContent);
        scanObject = pe.getScanObject();
        if (scanObject == null) {
            ZipScanObjectBuilder zip = new ZipScanObjectBuilder(objectContent);
            scanObject = zip.getScanObject();
        }
        return scanObject;
    }
}
